dplyr::select(longitude, latitude)
precip_asexual_nive <- raster::extract(precip_deviation, nive_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_nive <- raster::extract(precip_deviation, sexual_locs) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_nive <- bind_rows(precip_asexual_nive, precip_sexual_nive)
ggplot(data = precip_df_nive, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_nive <- raster::extract(temp_deviation, nive_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_nive <- raster::extract(temp_deviation, nive_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_nive <- bind_rows(temp_asexual_nive, temp_sexual_nive)
ggplot(data = temp_df_nive, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
summary_list_spin <- species_pca_fun(loc_clim, "spinotectarchus")
spin_plot <- plot_clim_pca(summary_list_spin$loc_clim, summary_list_spin$summary_pca, factor = "reproductive_mode")
spin_plot
#if selfcontained = TRUE, you can remove the folder that gets added alongside the plot. It's an annoying bug that hasn't been fixed yet.
#htmlwidgets::saveWidget(spin_plot, paste0(getwd(), "/plots/repro_mode_plots/spinotectarchus_pca.html"), selfcontained = TRUE)
#filter localities for the focal genus
spin_loc <- loc %>%
filter(genus == "spinotectarchus")
#use sourced plot_locs_leaflet script to plot localities
spin_map <- plot_locs_leaflet(spin_loc, "reproductive_mode")
spin_map
#in case I want to save the map somewhere
#mapview::mapshot(spin_map, url = paste0(getwd(), "/plots/repro_mode_plots/spin_map.html"), file = paste0(getwd(), "/plots/repro_mode_plots/spin_map.pdf"))
summary_list_spin$summary_pca
loadings_spin <- summary_list_spin$summary_pca$rotation
knitr::kable(round(loadings_spin[,1:3],3)) #Table of loading scores for the first 3 PCs.
summary_list_tect <- species_pca_fun(loc_clim, "tectarchus")
tect_plot <- plot_clim_pca(summary_list_tect$loc_clim, summary_list_tect$summary_pca, factor = "reproductive_mode")
tect_plot
#if selfcontained = TRUE, you can remove the folder that gets added alongside the plot. It's an annoying bug that hasn't been fixed yet.
#htmlwidgets::saveWidget(tect_plot, paste0(getwd(), "/plots/repro_mode_plots/tectarchus_pca.html"), selfcontained = TRUE)
#filter localities for the focal genus
tect_loc <- loc %>%
filter(genus == "tectarchus")
#use sourced plot_locs_leaflet script to plot localities
tect_map <- plot_locs_leaflet(tect_loc, "reproductive_mode")
tect_map
#in case I want to save the map somewhere
#mapview::mapshot(tect_map, url = paste0(getwd(), "/plots/repro_mode_plots/tect_map.html"), file = paste0(getwd(), "/plots/repro_mode_plots/tect_map.pdf"))
summary_list_tect$summary_pca
loadings_tect <- summary_list_tect$summary_pca$rotation
knitr::kable(round(loadings_tect[,1:3],3)) #Table of loading scores for the first 3 PCs.
#get background env't for the species
tect_ovo_bg_env <- bg_env_crop(tect_loc,
species = "ovobessus",
environment = w,
buffer = 0.5)
#enfa for the sexual species
tect_ovo_sexual_enfa <- enfa_calc_fun(locs = tect_loc,
species = "ovobessus",
reproductive_mode = "sexual",
mask_raster = tect_ovo_bg_env)
#enfa for the asexual species
tect_ovo_asexual_enfa <- enfa_calc_fun(locs = tect_loc,
species = "ovobessus",
reproductive_mode = "asexual",
mask_raster = tect_ovo_bg_env)
#plot the marginality scores
marginality_lollipop(sex_marg = tect_ovo_sexual_enfa$m,
asex_marg = tect_ovo_asexual_enfa$m,
full_species_name = "Tectarchus ovobessus")
### 1) ENFA scatterplot
#access the relevant values for plotting
tect_ovo_asexual_df <- tect_ovo_asexual_enfa$li %>%
as_tibble() %>%
bind_cols(pr = tect_ovo_asexual_enfa$pr)
tect_ovo_sexual_df <- tect_ovo_sexual_enfa$li %>%
as_tibble() %>%
bind_cols(pr = tect_ovo_sexual_enfa$pr)
#asexual
enfa_hex_plot(tect_ovo_asexual_df, marg = Mar, spec = Spe1, repro_mode = "Asexual")
#sexual
enfa_hex_plot(tect_ovo_sexual_df, marg = Mar, spec = Spe1, repro_mode = "Sexual")
### 2) ENFA histogram
#asexual
hist(tect_ovo_asexual_enfa)
title(main = "Asexual", adj = 0.7, line = -12)
#sexual
hist(tect_ovo_sexual_enfa)
title(main = "Sexual", adj = 0.7, line = -12)
### 3) PCA of total e-space
total_climate_pca_plot(bg_env = tect_ovo_bg_env, locs = tect_loc, genus = "Tectarchus", species = "ovobessus")
tect_locs_asexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(reproductive_mode == "asexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
tect_locs_sexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(reproductive_mode == "sexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
precip_asexual_tect_ovo <- raster::extract(precip_deviation, tect_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_tect_ovo <- raster::extract(precip_deviation, sexual_locs) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_tect_ovo <- bind_rows(precip_asexual_tect_ovo, precip_sexual_tect_ovo)
ggplot(data = precip_df_tect_ovo, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_tect_ovo <- raster::extract(temp_deviation, tect_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_tect_ovo <- raster::extract(temp_deviation, tect_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_tect_ovo <- bind_rows(temp_asexual_tect_ovo, temp_sexual_tect_ovo)
ggplot(data = temp_df_tect_ovo, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
tect_locs_asexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(species == "ovobessus",
reproductive_mode == "asexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
tect_locs_sexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(species == "ovobessus",
reproductive_mode == "sexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
precip_asexual_tect_ovo <- raster::extract(precip_deviation, tect_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_tect_ovo <- raster::extract(precip_deviation, sexual_locs) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_tect_ovo <- bind_rows(precip_asexual_tect_ovo, precip_sexual_tect_ovo)
ggplot(data = precip_df_tect_ovo, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_tect_ovo <- raster::extract(temp_deviation, tect_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_tect_ovo <- raster::extract(temp_deviation, tect_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_tect_ovo <- bind_rows(temp_asexual_tect_ovo, temp_sexual_tect_ovo)
ggplot(data = temp_df_tect_ovo, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
tect_locs_asexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(species == "ovobessus",
reproductive_mode == "asexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
tect_locs_sexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(species == "ovobessus",
reproductive_mode == "sexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
precip_asexual_tect_ovo <- raster::extract(precip_deviation, tect_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_tect_ovo <- raster::extract(precip_deviation, tect_locs_sexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_tect_ovo <- bind_rows(precip_asexual_tect_ovo, precip_sexual_tect_ovo)
ggplot(data = precip_df_tect_ovo, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_tect_ovo <- raster::extract(temp_deviation, tect_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_tect_ovo <- raster::extract(temp_deviation, tect_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_tect_ovo <- bind_rows(temp_asexual_tect_ovo, temp_sexual_tect_ovo)
ggplot(data = temp_df_tect_ovo, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
```{r}
tect_locs_asexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(species == "ovobessus",
reproductive_mode == "asexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
tect_locs_sexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(species == "ovobessus",
reproductive_mode == "sexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
precip_asexual_tect_ovo <- raster::extract(precip_deviation, tect_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_tect_ovo <- raster::extract(precip_deviation, tect_locs_sexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_tect_ovo <- bind_rows(precip_asexual_tect_ovo, precip_sexual_tect_ovo)
ggplot(data = precip_df_tect_ovo, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_tect_ovo <- raster::extract(temp_deviation, tect_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_tect_ovo <- raster::extract(temp_deviation, tect_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_tect_ovo <- bind_rows(temp_asexual_tect_ovo, temp_sexual_tect_ovo)
ggplot(data = temp_df_tect_ovo, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
tect_ovo_locs_asexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(species == "ovobessus",
reproductive_mode == "asexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
tect_ovo_locs_sexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(species == "ovobessus",
reproductive_mode == "sexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
precip_asexual_tect_ovo <- raster::extract(precip_deviation, tect_ovo_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_tect_ovo <- raster::extract(precip_deviation, tect_ovo_locs_sexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_tect_ovo <- bind_rows(precip_asexual_tect_ovo, precip_sexual_tect_ovo)
ggplot(data = precip_df_tect_ovo, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_tect_ovo <- raster::extract(temp_deviation, tect_ovo_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_tect_ovo <- raster::extract(temp_deviation, tect_ovo_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_tect_ovo <- bind_rows(temp_asexual_tect_ovo, temp_sexual_tect_ovo)
ggplot(data = temp_df_tect_ovo, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
nive_locs_asexual <- nive_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(reproductive_mode == "asexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
nive_locs_sexual <- nive_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(reproductive_mode == "sexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
precip_asexual_nive <- raster::extract(precip_deviation, nive_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_nive <- raster::extract(precip_deviation, nive_locs_sexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_nive <- bind_rows(precip_asexual_nive, precip_sexual_nive)
ggplot(data = precip_df_nive, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_nive <- raster::extract(temp_deviation, nive_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_nive <- raster::extract(temp_deviation, nive_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_nive <- bind_rows(temp_asexual_nive, temp_sexual_nive)
ggplot(data = temp_df_nive, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
clita_locs_asexual <- clita_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(reproductive_mode == "asexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
clita_locs_sexual <- clita_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(reproductive_mode == "sexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
precip_asexual_choo <- raster::extract(precip_deviation, clita_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_choo <- raster::extract(precip_deviation, clita_locs_sexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_choo <- bind_rows(precip_asexual_choo, precip_sexual_choo)
ggplot(data = precip_df_choo, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_choo <- raster::extract(temp_deviation, clita_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_choo <- raster::extract(temp_deviation, clita_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_choo <- bind_rows(temp_asexual_choo, temp_sexual_choo)
ggplot(data = temp_df_choo, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
aste_locs_asexual <- aste_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(reproductive_mode == "asexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
aste_locs_sexual <- aste_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(reproductive_mode == "sexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
precip_asexual_ajuc <- raster::extract(precip_deviation, aste_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_ajuc <- raster::extract(precip_deviation, aste_locs_sexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_ajuc <- bind_rows(precip_asexual_ajuc, precip_sexual_ajuc)
ggplot(data = precip_df_ajuc, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_ajuc <- raster::extract(temp_deviation, aste_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_ajuc <- raster::extract(temp_deviation, aste_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_ajuc <- bind_rows(temp_asexual_ajuc, temp_sexual_ajuc)
ggplot(data = temp_df_ajuc, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
argo_locs_asexual <- argo_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(reproductive_mode == "asexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
argo_locs_sexual <- argo_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(reproductive_mode == "sexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
precip_asexual_ahor <- raster::extract(precip_deviation, argo_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_ahor <- raster::extract(precip_deviation, argo_locs_sexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_ahor <- bind_rows(precip_asexual_ahor, precip_sexual_ahor)
ggplot(data = precip_df_ahor, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_ahor <- raster::extract(temp_deviation, argo_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_ahor <- raster::extract(temp_deviation, argo_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_ahor <- bind_rows(temp_asexual_ahor, temp_sexual_ahor)
ggplot(data = temp_df_ahor, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
###Only need to get bg env't if you're not running the previous chunk
#get background env't for the species
tect_hutt_bg_env <- bg_env_crop(tect_loc,
species = "huttoni",
environment = w,
buffer = 0.5)
#enfa for the sexual species
tect_hutt_sexual_enfa <- enfa_calc_fun(locs = tect_loc,
species = "huttoni",
reproductive_mode = "sexual",
mask_raster = tect_hutt_bg_env)
#enfa for the asexual species
tect_hutt_asexual_enfa <- enfa_calc_fun(locs = tect_loc,
species = "huttoni",
reproductive_mode = "asexual",
mask_raster = tect_hutt_bg_env)
#plot the marginality scores
marginality_lollipop(sex_marg = tect_hutt_sexual_enfa$m,
asex_marg = tect_hutt_asexual_enfa$m,
full_species_name = "Tectarchus huttoni")
### 1) ENFA scatterplot
#access the relevant values for plotting
tect_hutt_asexual_df <- tect_hutt_asexual_enfa$li %>%
as_tibble() %>%
bind_cols(pr = tect_hutt_asexual_enfa$pr)
tect_hutt_sexual_df <- tect_hutt_sexual_enfa$li %>%
as_tibble() %>%
bind_cols(pr = tect_hutt_sexual_enfa$pr)
#asexual
enfa_hex_plot(tect_hutt_asexual_df, marg = Mar, spec = Spe1, repro_mode = "Asexual")
#sexual
enfa_hex_plot(tect_hutt_sexual_df, marg = Mar, spec = Spe1, repro_mode = "Sexual")
### 2) ENFA histogram
#asexual
hist(tect_hutt_asexual_enfa)
title(main = "Asexual", adj = 0.7, line = -12)
#sexual
hist(tect_hutt_sexual_enfa)
title(main = "Sexual", adj = 0.7, line = -12)
### 3) PCA of total e-space
total_climate_pca_plot(bg_env = tect_hutt_bg_env, locs = tect_loc, genus = "Tectarchus", species = "huttoni")
tect_hutt_locs_asexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(species == "huttoni",
reproductive_mode == "asexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
tect_hutt_locs_sexual <- tect_loc %>%
mutate(lat_long = str_c(latitude, longitude, sep = "_")) %>%
filter(species == "huttoni",
reproductive_mode == "sexual",
!duplicated(lat_long)) %>%
dplyr::select(longitude, latitude)
precip_asexual_tect_hutt <- raster::extract(precip_deviation, tect_hutt_locs_asexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "asexual")
precip_sexual_tect_hutt <- raster::extract(precip_deviation, tect_hutt_locs_sexual) %>%
enframe(name = NULL, value = "precip_deviation") %>%
mutate(reproductive_mode = "sexual")
precip_df_tect_hutt <- bind_rows(precip_asexual_tect_hutt, precip_sexual_tect_hutt)
ggplot(data = precip_df_tect_hutt, aes(x = reproductive_mode, y = precip_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
temp_asexual_tect_hutt <- raster::extract(temp_deviation, tect_hutt_locs_asexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "asexual")
temp_sexual_tect_hutt <- raster::extract(temp_deviation, tect_hutt_locs_sexual) %>%
enframe(name = NULL, value = "temp_deviation") %>%
mutate(reproductive_mode = "sexual")
temp_df_tect_hutt <- bind_rows(temp_asexual_tect_hutt, temp_sexual_tect_hutt)
ggplot(data = temp_df_tect_hutt, aes(x = reproductive_mode, y = temp_deviation, color = reproductive_mode)) +
geom_boxplot(width = 0.5, color = "black", fill = "transparent") +
geom_jitter(width = 0.2, alpha = 0.6) +
scale_color_viridis_d(option = "magma") +
theme_dark()
plot(precip_deviation)
precip_nz <- precip_deviation %>% crop(w)
plot(precip_deviation)
plot(precip_deviation, viridis::viridis())
plot(precip_deviation, viridis::viridis(20))
?raster::plot
plot(precip_deviation, col = viridis::viridis(20))
precip_deviation
plot(precip_nz, col = viridis::viridis(20))
?climateStability::deviationThroughTime()
packages <- c("raster", "data.table", "sf", "tidyverse", "RStoolbox", "leaflet", "plotly", "gdata", "BSDA", "ade4", "readxl", "janitor", "rnaturalearth", "adehabitatHS", "climateStability", "ggspatial") #RStoolbox has some dependencies like openMP that can be difficult to compile on a Mac (needed for the dependent package "caret"). If you have High Sierra OS or newer, search for instructions specific to your OS- it's a lot easier than older OS's.
lapply(packages, require, character.only = TRUE)
source("R/plot_leaflet_function.R") #source locality plotting function
source("R/plot_climate_pca_function.R") #source pca plotting function
source("R/species_pca_function.R") #source function that computes climate pca per species
source("R/min_convex_poly.R") #source function that creates a minimum convex polygon around points
source("R/enfa_calc_function.R")
source("R/marginality_lollipop_plot.R")
source("R/presence_absence_raster_function.R")
source("R/crop_background_env_function.R")
source("R/enfa_hex_plot.R")
source("R/total_climate_pca_plot.R")
source("R/raster_correlation_function.R")
